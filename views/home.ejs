<main>
    <div id="title"> 
        <h1><%=title%></h1>
    </div>
    <div id="post-layout">
        <section>
            <h2>Posts</h2>
            <%if(locals.user){%>
            <form action="/posts/create" id="new-post-form" method="POST">
                <textarea name="content" id="post-text" cols="30" rows="3" placeholder=" Write something here..." required></textarea>
                <input type="submit" value="POST" class="post-submit">
            </form>
            <%}%>
        </section>
  
        <ul>
            <%for(post of posts){%>
            <h4>
                <li>
                <%=post.content%>
                </li>
            </h4>
                <p>
                <small> by: <%=post.user.name%> </small> </p>
            
                <div class="post-comments">
                    <%if(locals.user){%>
                        <form action="/comments/create" method="POST">
                        <input type="text" name="content" placeholder="Write a comment..." required>
                        <input type="hidden" name="post" value="<%=post._id%>">
                        <input type="submit" value="Add Comment">
                            </form>
                        <%}%>
                        <div class="post-comments-list">
                        <ul id="post-comment-<%=post._id%>">
                            <%for(comment of post.comments){%>
                                <p> 
                                    <small>
                                        <%=comment.user.name%>
                                        </small>
                                        <br>
                                    <%=comment.content%>
                                    
                                </p>

                                <%}%>
                        </ul>
                        </div>
                </div>
                <%}%>
        </ul>
    </div>
</main>